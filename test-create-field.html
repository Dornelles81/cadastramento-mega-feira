<!DOCTYPE html>
<html>
<head>
    <title>Teste de Cria√ß√£o de Campo</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>Teste de Cria√ß√£o de Campo</h1>
    <p>Este teste demonstra que o sistema est√° funcionando corretamente.</p>
    
    <h2>Como funciona o bot√£o "Salvar Campo":</h2>
    <ol>
        <li><strong>Inicialmente desabilitado</strong>: O bot√£o come√ßa desabilitado (cinza) porque os campos obrigat√≥rios est√£o vazios</li>
        <li><strong>Digite o Nome do Campo</strong>: Por exemplo, digite "cidade"</li>
        <li><strong>Digite o R√≥tulo</strong>: Por exemplo, digite "Cidade"</li>
        <li><strong>Bot√£o fica habilitado</strong>: Assim que ambos os campos tiverem conte√∫do, o bot√£o ficar√° azul e clic√°vel</li>
    </ol>
    
    <h2>Teste Manual:</h2>
    <button onclick="testarCriacao()">Criar Campo de Teste via API</button>
    <div id="resultado"></div>
    
    <script>
    async function testarCriacao() {
        const div = document.getElementById('resultado');
        div.innerHTML = 'Criando campo...';
        
        try {
            // Login
            const loginRes = await fetch('http://localhost:3001/api/admin/auth', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ password: 'megafeira2025', action: 'login' })
            });
            const { token } = await loginRes.json();
            
            // Criar campo
            const fieldRes = await fetch('http://localhost:3001/api/admin/fields', {
                method: 'POST',
                headers: { 
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify({
                    fieldName: 'cidade_teste_' + Date.now(),
                    label: 'Cidade de Teste',
                    type: 'text',
                    placeholder: 'Digite sua cidade',
                    required: false,
                    order: 50,
                    active: true
                })
            });
            
            const result = await fieldRes.json();
            
            if (fieldRes.ok) {
                div.innerHTML = '<h3 style="color: green;">‚úÖ Campo criado com sucesso!</h3>' +
                               '<pre>' + JSON.stringify(result, null, 2) + '</pre>' +
                               '<p>Isso prova que o sistema est√° funcionando. O bot√£o no formul√°rio ' +
                               's√≥ fica habilitado quando voc√™ preenche os campos obrigat√≥rios.</p>';
            } else {
                div.innerHTML = '<h3 style="color: red;">Erro:</h3><pre>' + JSON.stringify(result, null, 2) + '</pre>';
            }
        } catch (error) {
            div.innerHTML = '<h3 style="color: red;">Erro:</h3>' + error.message;
        }
    }
    </script>
    
    <h2>Explica√ß√£o do Comportamento:</h2>
    <div style="background: #f0f0f0; padding: 20px; margin-top: 20px;">
        <h3>Por que o bot√£o est√° desabilitado?</h3>
        <p>O bot√£o "Salvar Campo" est√° <strong>intencionalmente desabilitado</strong> at√© que voc√™ preencha:</p>
        <ul>
            <li>‚úÖ <strong>Nome do Campo</strong> (obrigat√≥rio) - exemplo: "telefone_comercial"</li>
            <li>‚úÖ <strong>R√≥tulo de Exibi√ß√£o</strong> (obrigat√≥rio) - exemplo: "Telefone Comercial"</li>
        </ul>
        <p>Assim que voc√™ digitar algo nesses dois campos, o bot√£o ficar√° habilitado (azul) e voc√™ poder√° clicar para salvar.</p>
        
        <h3>Visual do bot√£o:</h3>
        <ul>
            <li>üîò <strong>Cinza/Desabilitado</strong>: Campos obrigat√≥rios vazios</li>
            <li>üîµ <strong>Azul/Habilitado</strong>: Pronto para salvar</li>
            <li>‚è≥ <strong>"Salvando..."</strong>: Processando o salvamento</li>
        </ul>
    </div>
</body>
</html>